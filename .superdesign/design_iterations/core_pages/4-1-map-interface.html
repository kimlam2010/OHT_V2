<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OHT-50 - Map & Navigation</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../../themes/theme_oht50_unified.css">
    <link rel="stylesheet" href="../../themes/theme_components.css">
    <style>
        .page-container{display:flex;flex-direction:column;min-height:100vh;background:var(--bg-secondary);padding-top:80px}
        .top-navigation{position:fixed;top:0;left:0;right:0;display:flex;align-items:center;justify-content:space-between;padding:var(--space-md) var(--space-lg);background:var(--bg-primary);border-bottom:var(--border-width-1) solid var(--border-color-light);box-shadow:var(--shadow-sm);z-index:var(--z-sticky)}
        .nav-brand{display:flex;align-items:center;gap:var(--space-sm);font-family:var(--font-display);font-size:var(--text-xl);font-weight:var(--font-bold);color:var(--primary-orange)}
        .nav-emergency-controls{display:flex;align-items:center;gap:var(--space-sm);margin-left:var(--space-lg)}
        .btn-emergency-nav{display:flex;align-items:center;gap:var(--space-xs);padding:var(--space-sm) var(--space-md);background:var(--safety-red);color:#fff;border:0;border-radius:var(--radius-md);font-size:var(--text-sm);font-weight:var(--font-bold);cursor:pointer;transition:all var(--transition-fast);box-shadow:var(--shadow-sm)}
        .btn-emergency-nav:hover{background:var(--error-red-dark);transform:translateY(-1px);box-shadow:var(--shadow-md)}
        .btn-nav{display:flex;align-items:center;gap:var(--space-xs);padding:var(--space-sm) var(--space-md);border:var(--border-width-1) solid var(--border-color-light);border-radius:var(--radius-md);font-size:var(--text-sm);font-weight:var(--font-medium);cursor:pointer;transition:all var(--transition-fast)}
        .btn-warning-nav{background:var(--warning-yellow);color:var(--industrial-gray-900);border-color:var(--warning-yellow)}
        .btn-warning-nav:hover{background:var(--warning-yellow-dark);color:#fff}
        .btn-success-nav{background:var(--success-green);color:#fff;border-color:var(--success-green)}
        .btn-success-nav:hover{background:var(--success-green-dark)}
        .nav-menu{display:flex;align-items:center;gap:var(--space-lg)}
        .nav-item{display:flex;align-items:center;gap:var(--space-xs);padding:var(--space-sm) var(--space-md);color:var(--industrial-gray-700);text-decoration:none;border-radius:var(--radius-md);transition:all var(--transition-fast);font-weight:var(--font-medium)}
        .nav-item:hover{background:var(--industrial-gray-100);color:var(--primary-orange)}
        .nav-item.active{background:var(--primary-orange);color:#fff}
        .nav-actions{display:flex;align-items:center;gap:var(--space-sm)}
        .nav-btn{display:flex;align-items:center;justify-content:center;width:40px;height:40px;background:var(--bg-secondary);border:var(--border-width-1) solid var(--border-color-light);border-radius:var(--radius-md);color:var(--industrial-gray-600);transition:all var(--transition-fast)}
        .nav-btn:hover{background:var(--primary-orange);color:#fff;border-color:var(--primary-orange)}
        .page-main{flex:1;padding:var(--space-lg)}
        .page-content{max-width:1920px;margin:0 auto}
        .breadcrumb-nav{display:flex;align-items:center;gap:var(--space-sm);padding:var(--space-sm) 0;margin-bottom:var(--space-lg)}
        .breadcrumb-item{color:var(--industrial-gray-600);text-decoration:none;font-size:var(--text-sm)}
        .breadcrumb-item:hover{color:var(--primary-orange)}
        .breadcrumb-item.active{color:var(--industrial-gray-900);font-weight:var(--font-medium)}
        .breadcrumb-separator{color:var(--industrial-gray-400)}
        .content-grid{display:grid;grid-template-columns:repeat(12,1fr);gap:var(--space-lg)}
        .map-container{grid-column:span 12;background:var(--industrial-gray-900);border-radius:var(--radius-xl);height:560px;position:relative;box-shadow:var(--shadow-md)}
        .map-controls{position:absolute;top:var(--space-md);right:var(--space-md);display:flex;gap:var(--space-sm)}
        .map-btn{width:40px;height:40px;display:flex;align-items:center;justify-content:center;background:#fff;border:var(--border-width-1) solid var(--industrial-gray-200);border-radius:var(--radius-md);cursor:pointer;transition:all var(--transition-fast)}
        .map-btn:hover{transform:translateY(-1px);box-shadow:var(--shadow-sm)}
        .map-hud{position:absolute;left:var(--space-md);bottom:var(--space-md);background:rgba(0,0,0,.6);color:#fff;padding:var(--space-sm) var(--space-md);border-radius:var(--radius-md);font-family:var(--font-mono);font-size:var(--text-sm)}
        @media (max-width:1024px){.nav-menu{gap:var(--space-md)}.nav-item{padding:var(--space-xs) var(--space-sm);font-size:var(--text-sm)}}
        @media (max-width:768px){.nav-menu{display:none}.nav-menu.open{display:flex;position:absolute;top:60px;left:0;right:0;background:var(--bg-primary);padding:var(--space-md);gap:var(--space-md);border-bottom:var(--border-width-1) solid var(--border-color-light)}.nav-emergency-controls{margin-left:var(--space-sm);gap:var(--space-xs)}.btn-emergency-nav,.btn-nav{padding:var(--space-xs) var(--space-sm);font-size:var(--text-xs)}.btn-emergency-nav i,.btn-nav i{width:12px;height:12px}.page-container{padding-top:60px}.content-grid{grid-template-columns:repeat(6,1fr);gap:var(--space-md)}}
        @media (max-width:640px){.content-grid{grid-template-columns:repeat(2,1fr);gap:var(--space-sm)}}
        .skip-link{position:absolute;top:-40px;left:6px;background:var(--primary-orange);color:#fff;padding:var(--space-sm) var(--space-md);text-decoration:none;border-radius:var(--radius-md);z-index:var(--z-emergency)}
        .skip-link:focus{top:6px}
        .nav-item:focus-visible,.btn:focus-visible,.nav-btn:focus-visible,.btn-emergency-nav:focus-visible,.map-btn:focus-visible{outline:var(--border-width-2) solid var(--primary-orange);outline-offset:var(--space-xs)}
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <div class="page-container">
        <nav class="top-navigation" role="navigation" aria-label="Main navigation">
            <div class="nav-brand">
                <i data-lucide="map" class="w-6 h-6" aria-hidden="true"></i>
                <span>OHT-50</span>
            </div>
            <button class="nav-btn" id="menu-toggle" aria-label="Toggle menu" aria-controls="main-menu" aria-expanded="false"><i data-lucide="menu"></i></button>
            <div class="nav-emergency-controls">
                <button class="btn-emergency-nav" id="emergency-stop" aria-label="Emergency Stop">
                    <i data-lucide="square" class="w-4 h-4" aria-hidden="true"></i>
                    E-STOP
                </button>
                <button class="btn-nav btn-warning-nav" id="pause-system" aria-label="Pause System">
                    <i data-lucide="pause" class="w-4 h-4" aria-hidden="true"></i>
                    Pause
                </button>
                <button class="btn-nav btn-success-nav" id="reset-system" aria-label="Reset System">
                    <i data-lucide="refresh-cw" class="w-4 h-4" aria-hidden="true"></i>
                    Reset
                </button>
            </div>
            <div class="nav-menu" id="main-menu">
                <a href="../core_pages/2-1-dashboard-main.html" class="nav-item" aria-label="Dashboard"><i data-lucide="layout-dashboard" class="w-4 h-4" aria-hidden="true"></i>Dashboard</a>
                <a href="../core_pages/3-1-control-panel.html" class="nav-item" aria-label="Control Panel"><i data-lucide="gamepad-2" class="w-4 h-4" aria-hidden="true"></i>Control Panel</a>
                <a href="../core_pages/4-1-map-interface.html" class="nav-item" aria-label="Map & Navigation"><i data-lucide="map" class="w-4 h-4" aria-hidden="true"></i>Map & Navigation</a>
                <a href="../functional_pages/5-1-monitoring-interface.html" class="nav-item" aria-label="Monitoring"><i data-lucide="monitor" class="w-4 h-4" aria-hidden="true"></i>Monitoring</a>
                <a href="../functional_pages/6-1-configuration.html" class="nav-item" aria-label="Configuration"><i data-lucide="settings" class="w-4 h-4" aria-hidden="true"></i>Configuration</a>
                <a href="../functional_pages/7-1-reports.html" class="nav-item" aria-label="Reports"><i data-lucide="file-text" class="w-4 h-4" aria-hidden="true"></i>Reports</a>
                <a href="../advanced_pages/8-1-alerts.html" class="nav-item" aria-label="Alerts"><i data-lucide="bell" class="w-4 h-4" aria-hidden="true"></i>Alerts</a>
                <a href="../advanced_pages/9-1-voice-control.html" class="nav-item" aria-label="Voice"><i data-lucide="mic" class="w-4 h-4" aria-hidden="true"></i>Voice</a>
                <a href="../../documentation/INDEX.html" class="nav-item" aria-label="Docs"><i data-lucide="book" class="w-4 h-4" aria-hidden="true"></i>Docs</a>
            </div>
            <div class="nav-actions">
                <button class="nav-btn" aria-label="Notifications"><i data-lucide="bell" class="w-5 h-5" aria-hidden="true"></i></button>
                <button class="nav-btn" aria-label="User menu"><i data-lucide="user" class="w-5 h-5" aria-hidden="true"></i></button>
            </div>
        </nav>
        <main id="main-content" class="page-main" tabindex="-1">
            <div class="page-content">
                <nav class="breadcrumb-nav" aria-label="Breadcrumb">
                    <a href="../core_pages/2-1-dashboard-main.html" class="breadcrumb-item">Dashboard</a>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-item active">Map & Navigation</span>
                </nav>
                <header class="page-header">
                    <h1 class="page-title">Map & Navigation</h1>
                    <p class="page-description">Real-time map visualization and navigation controls</p>
                </header>
                <div class="content-grid">
                    <section class="map-container" aria-label="Map container">
                        <div class="map-controls" aria-label="Map controls">
                            <button class="map-btn" id="zoom-in" aria-label="Zoom in"><i data-lucide="zoom-in"></i></button>
                            <button class="map-btn" id="zoom-out" aria-label="Zoom out"><i data-lucide="zoom-out"></i></button>
                            <button class="map-btn" id="reset-view" aria-label="Reset view"><i data-lucide="refresh-cw"></i></button>
                            <button class="map-btn" id="fullscreen" aria-label="Fullscreen"><i data-lucide="maximize"></i></button>
                        </div>
                        <div class="map-hud" id="map-hud" aria-live="polite">Zoom: 100% | X: 0, Y: 0 | FS: Off | Link: Online</div>
                    </section>
                    <section style="grid-column: span 12;">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="card">
                                <div class="card-header"><h3 class="card-title">Path Planning</h3></div>
                                <div class="card-body">
                                    <div class="form-group">
                                        <label class="form-label" for="planning-mode">Planning Mode</label>
                                        <select id="planning-mode" class="form-select">
                                            <option value="auto">Automatic</option>
                                            <option value="manual">Manual</option>
                                            <option value="optimized">Optimized</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-header"><h3 class="card-title">Obstacle Detection</h3></div>
                                <div class="card-body"><p class="text-industrial-gray-600 text-sm">Status: Active</p></div>
                            </div>
                            <div class="card">
                                <div class="card-header"><h3 class="card-title">Navigation Status</h3></div>
                                <div class="card-body"><span class="badge badge-success">AUTO</span></div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </main>
    </div>
    <script>
        lucide.createIcons();
        (function(){
            const $ = s => document.querySelector(s);
            const $$ = s => document.querySelectorAll(s);

            // Mobile hamburger toggle
            const menuToggle = $('#menu-toggle');
            const menu = $('#main-menu');
            if (menuToggle && menu) {
                menuToggle.addEventListener('click', () => {
                    const opened = menu.classList.toggle('open');
                    menuToggle.setAttribute('aria-expanded', String(opened));
                });
            }

            // Emergency Controls
            class EmergencyControls {
                constructor(){ this.init(); }
                init(){
                    $('#emergency-stop')?.addEventListener('click',()=>this.eStop());
                    $('#pause-system')?.addEventListener('click',()=>this.pause());
                    $('#reset-system')?.addEventListener('click',()=>this.reset());
                    document.addEventListener('keydown',e=>{
                        if(e.key==='Escape'){e.preventDefault();this.eStop();}
                        if(e.key==='p' || e.key==='P'){e.preventDefault();this.pause();}
                        if(e.key==='r' || e.key==='R'){e.preventDefault();this.reset();}
                    });
                }
                eStop(){
                    const btn = $('#emergency-stop');
                    if (!btn) return;
                    btn.classList.add('animate-pulse');
                    setTimeout(()=>btn.classList.remove('animate-pulse'), 1000);
                    alert('EMERGENCY STOP');
                }
                pause(){ console.log('Paused'); }
                reset(){ console.log('Reset'); }
            }

            // Active state based on file path
            function setActiveByPath(){
                const path = window.location.pathname;
                $$('.nav-item').forEach(a => {
                    const href = a.getAttribute('href') || '';
                    if (href && path.endsWith(href.split('/').pop() || '')){
                        a.classList.add('active');
                        a.setAttribute('aria-current','page');
                    } else {
                        a.classList.remove('active');
                        a.removeAttribute('aria-current');
                    }
                });
            }

            // Map interactions
            const hud = $('#map-hud');
            let zoom = 100; let posX = 0; let posY = 0; let fs = false; let linkOk = true;
            function updateHUD(){
                if (hud) hud.textContent = `Zoom: ${zoom}% | X: ${posX}, Y: ${posY} | FS: ${fs?'On':'Off'} | Link: ${linkOk?'Online':'Lost'}`;
            }
            function zoomIn(){ zoom = Math.min(300, zoom + 10); updateHUD(); feedback('#zoom-in'); }
            function zoomOut(){ zoom = Math.max(10, zoom - 10); updateHUD(); feedback('#zoom-out'); }
            function resetView(){ zoom = 100; posX = 0; posY = 0; updateHUD(); feedback('#reset-view'); }
            function toggleFullscreen(){ fs = !fs; updateHUD();
                const icon = $('#fullscreen i');
                if (icon) icon.setAttribute('data-lucide', fs ? 'minimize' : 'maximize');
                lucide.createIcons();
                feedback('#fullscreen');
            }
            function feedback(sel){ const b=$(sel); if(!b) return; b.style.transform='scale(0.95)'; setTimeout(()=>b.style.transform='',120); }

            $('#zoom-in')?.addEventListener('click', zoomIn);
            $('#zoom-out')?.addEventListener('click', zoomOut);
            $('#reset-view')?.addEventListener('click', resetView);
            $('#fullscreen')?.addEventListener('click', toggleFullscreen);

            // Keyboard shortcuts: +/-, arrows pan
            document.addEventListener('keydown', e => {
                if (e.key === '+' || e.key === '=') { e.preventDefault(); zoomIn(); }
                if (e.key === '-') { e.preventDefault(); zoomOut(); }
                if (['ArrowUp','ArrowDown','ArrowLeft','ArrowRight'].includes(e.key)) {
                    e.preventDefault();
                    const delta = 10;
                    if (e.key==='ArrowUp') posY -= delta;
                    if (e.key==='ArrowDown') posY += delta;
                    if (e.key==='ArrowLeft') posX -= delta;
                    if (e.key==='ArrowRight') posX += delta;
                    updateHUD();
                }
            });

            // Init
            new EmergencyControls();
            setActiveByPath();
            updateHUD();
        })();
    </script>
</body>
</html>
