<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OHT-50 Control Panel - Master Module</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Flowbite -->
    <script src="https://cdn.jsdelivr.net/npm/flowbite@2.0.0/dist/flowbite.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    
    <!-- Custom Theme CSS -->
    <link rel="stylesheet" href="theme_control_panel.css">
    
    <!-- Custom Animation CSS -->
    <style>
        /* Animation Keyframes */
        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulseEmergency {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7);
            }
            50% {
                box-shadow: 0 0 0 10px rgba(220, 38, 38, 0);
            }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% {
                transform: translate3d(0,0,0);
            }
            40%, 43% {
                transform: translate3d(0, -8px, 0);
            }
            70% {
                transform: translate3d(0, -4px, 0);
            }
            90% {
                transform: translate3d(0, -2px, 0);
            }
        }
        
        @keyframes countUp {
            from { content: "0"; }
            to { content: attr(data-value); }
        }
        
        /* Animation Classes */
        .animate-slide-in-left {
            animation: slideInLeft 0.3s ease-out;
        }
        
        .animate-slide-in-up {
            animation: slideInUp 0.4s ease-out;
        }
        
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out;
        }
        
        .animate-slide-down {
            animation: slideDown 0.3s ease-out;
        }
        
        .animate-pulse-emergency {
            animation: pulseEmergency 2s infinite;
        }
        
        .animate-shake {
            animation: shake 0.4s ease-out;
        }
        
        .animate-bounce {
            animation: bounce 0.6s ease-out;
        }
        
        /* Reduced Motion Support */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: hsl(var(--muted));
        }
        
        ::-webkit-scrollbar-thumb {
            background: hsl(var(--border));
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: hsl(var(--muted-foreground));
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>OHT-50 Control</h2>
            </div>
            
            <nav class="sidebar-nav">
                <a href="#" class="sidebar-nav-item" data-section="dashboard">
                    <i data-lucide="layout-dashboard"></i>
                    Dashboard
                </a>
                
                <a href="#" class="sidebar-nav-item active" data-section="robot-control">
                    <i data-lucide="robot"></i>
                    Robot Control
                </a>
                
                <div class="sidebar-submenu">
                    <a href="#" class="sidebar-submenu-item active" data-tab="manual-control">
                        <i data-lucide="gamepad-2"></i>
                        Manual Control
                    </a>
                    <a href="#" class="sidebar-submenu-item" data-tab="missions">
                        <i data-lucide="target"></i>
                        Missions
                    </a>
                    <a href="#" class="sidebar-submenu-item" data-tab="history-logs">
                        <i data-lucide="history"></i>
                        History & Logs
                    </a>
                </div>
                
                <a href="#" class="sidebar-nav-item" data-section="map">
                    <i data-lucide="map"></i>
                    Map Interface
                </a>
                
                <a href="#" class="sidebar-nav-item" data-section="configuration">
                    <i data-lucide="settings"></i>
                    Configuration
                </a>
                
                <a href="#" class="sidebar-nav-item" data-section="analytics">
                    <i data-lucide="bar-chart-3"></i>
                    Analytics
                </a>
                
                <a href="#" class="sidebar-nav-item" data-section="maintenance">
                    <i data-lucide="wrench"></i>
                    Maintenance
                </a>
                
                <a href="#" class="sidebar-nav-item" data-section="documentation">
                    <i data-lucide="file-text"></i>
                    Documentation
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Alert Banner -->
            <div class="alert-banner animate-slide-down">
                <div class="alert-item alert-critical animate-shake">
                    <i data-lucide="alert-triangle"></i>
                    <span>Emergency Stop Activated</span>
                </div>
                <div class="alert-item alert-warning">
                    <i data-lucide="battery"></i>
                    <span>Low Battery: 15%</span>
                </div>
                <div class="alert-item alert-info">
                    <i data-lucide="wifi"></i>
                    <span>Connected to Center</span>
                </div>
                <div class="alert-item alert-success">
                    <i data-lucide="check-circle"></i>
                    <span>System Online</span>
                </div>
                <div class="alert-item alert-info">
                    <i data-lucide="clock"></i>
                    <span>Last Update: 2s ago</span>
                </div>
            </div>

            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-button active" data-tab="manual-control">
                    <i data-lucide="gamepad-2"></i>
                    Manual Control
                </button>
                <button class="tab-button" data-tab="missions">
                    <i data-lucide="target"></i>
                    Missions
                </button>
                <button class="tab-button" data-tab="history-logs">
                    <i data-lucide="history"></i>
                    History & Logs
                </button>
            </div>

            <!-- Tab Content: Manual Control -->
            <div class="tab-content active" id="manual-control">
                <div class="control-grid">
                    <!-- Mode Selector -->
                    <div class="mode-selector animate-slide-in-up">
                        <h3>Operating Mode</h3>
                        <div class="mode-buttons">
                            <button class="mode-btn active" data-mode="manual">
                                <i data-lucide="hand"></i>
                                Manual
                            </button>
                            <button class="mode-btn" data-mode="auto">
                                <i data-lucide="play"></i>
                                Auto
                            </button>
                            <button class="mode-btn" data-mode="semi">
                                <i data-lucide="pause"></i>
                                Semi-Auto
                            </button>
                            <button class="mode-btn" data-mode="maint">
                                <i data-lucide="wrench"></i>
                                Maintenance
                            </button>
                        </div>
                    </div>

                    <!-- Movement Controls -->
                    <div class="movement-controls animate-slide-in-up">
                        <h3>Movement Control</h3>
                        <div class="movement-grid">
                            <button class="movement-btn" data-direction="forward">
                                <i data-lucide="chevron-up"></i>
                            </button>
                            <button class="movement-btn" data-direction="left">
                                <i data-lucide="chevron-left"></i>
                            </button>
                            <button class="movement-btn stop" data-direction="stop">
                                <i data-lucide="square"></i>
                            </button>
                            <button class="movement-btn" data-direction="right">
                                <i data-lucide="chevron-right"></i>
                            </button>
                            <button class="movement-btn" data-direction="backward">
                                <i data-lucide="chevron-down"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Speed Control -->
                    <div class="speed-control animate-slide-in-up">
                        <h3>Speed Control</h3>
                        <div class="speed-presets">
                            <button class="speed-preset" data-speed="25">Slow</button>
                            <button class="speed-preset active" data-speed="50">Normal</button>
                            <button class="speed-preset" data-speed="75">Fast</button>
                            <button class="speed-preset" data-speed="100">Max</button>
                        </div>
                        <input type="range" class="speed-slider" min="0" max="100" value="50">
                        <div class="speed-display">50%</div>
                    </div>

                    <!-- Emergency Controls -->
                    <div class="emergency-controls animate-slide-in-up">
                        <button class="estop-button animate-pulse-emergency" onclick="triggerEmergencyStop()">
                            <div class="estop-icon">⏹️</div>
                            <span>E-STOP</span>
                        </button>
                        <div class="emergency-actions">
                            <button class="emergency-btn" onclick="triggerPause()">
                                <i data-lucide="pause"></i>
                                Pause
                            </button>
                            <button class="emergency-btn" onclick="triggerReset()">
                                <i data-lucide="refresh-cw"></i>
                                Reset
                            </button>
                            <button class="emergency-btn danger" onclick="triggerHome()">
                                <i data-lucide="home"></i>
                                Home
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab Content: Missions -->
            <div class="tab-content" id="missions">
                <div class="animate-slide-in-up">
                    <h2>Mission Management</h2>
                    
                    <!-- Statistics -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" data-value="12">12</div>
                            <div class="stat-label">Active Missions</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" data-value="8">8</div>
                            <div class="stat-label">Completed Today</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" data-value="95">95%</div>
                            <div class="stat-label">Success Rate</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" data-value="2.5">2.5h</div>
                            <div class="stat-label">Avg Duration</div>
                        </div>
                    </div>

                    <!-- Mission Cards -->
                    <div class="mission-card">
                        <div class="mission-header">
                            <div class="mission-title">Transport Package A → B</div>
                            <div class="mission-status active">Active</div>
                        </div>
                        <div class="mission-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 65%"></div>
                            </div>
                        </div>
                        <div class="mission-info">
                            <span>Started: 14:30</span>
                            <span>ETA: 15:45</span>
                            <span>Progress: 65%</span>
                        </div>
                        <div class="mission-actions">
                            <button class="mission-btn primary">View Details</button>
                            <button class="mission-btn">Pause</button>
                            <button class="mission-btn danger">Cancel</button>
                        </div>
                    </div>

                    <div class="mission-card">
                        <div class="mission-header">
                            <div class="mission-title">Inspection Route C</div>
                            <div class="mission-status queued">Queued</div>
                        </div>
                        <div class="mission-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="mission-info">
                            <span>Priority: High</span>
                            <span>Duration: ~45min</span>
                            <span>Waypoints: 8</span>
                        </div>
                        <div class="mission-actions">
                            <button class="mission-btn primary">Start Now</button>
                            <button class="mission-btn">Edit</button>
                            <button class="mission-btn danger">Delete</button>
                        </div>
                    </div>

                    <div class="mission-card">
                        <div class="mission-header">
                            <div class="mission-title">Maintenance Check D</div>
                            <div class="mission-status completed">Completed</div>
                        </div>
                        <div class="mission-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 100%"></div>
                            </div>
                        </div>
                        <div class="mission-info">
                            <span>Completed: 13:15</span>
                            <span>Duration: 1h 20min</span>
                            <span>Status: Success</span>
                        </div>
                        <div class="mission-actions">
                            <button class="mission-btn primary">View Report</button>
                            <button class="mission-btn">Rerun</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab Content: History & Logs -->
            <div class="tab-content" id="history-logs">
                <div class="animate-slide-in-up">
                    <h2>History & Logs</h2>
                    
                    <!-- Filter Controls -->
                    <div style="margin-bottom: 1.5rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                        <button class="emergency-btn active">All</button>
                        <button class="emergency-btn">Control</button>
                        <button class="emergency-btn">Missions</button>
                        <button class="emergency-btn">System</button>
                        <button class="emergency-btn">Errors</button>
                    </div>

                    <!-- Log Items -->
                    <div class="log-item success">
                        <div class="log-time">15:42</div>
                        <div class="log-message">Mission "Transport Package A → B" completed successfully</div>
                        <div class="log-actions">
                            <button class="log-btn">Details</button>
                        </div>
                    </div>

                    <div class="log-item warning">
                        <div class="log-time">15:38</div>
                        <div class="log-message">Battery level below 20% - returning to charging station</div>
                        <div class="log-actions">
                            <button class="log-btn">Acknowledge</button>
                        </div>
                    </div>

                    <div class="log-item">
                        <div class="log-time">15:35</div>
                        <div class="log-message">Manual control activated - operator took control</div>
                        <div class="log-actions">
                            <button class="log-btn">Details</button>
                        </div>
                    </div>

                    <div class="log-item error">
                        <div class="log-time">15:30</div>
                        <div class="log-message">Communication timeout with Center - switching to local mode</div>
                        <div class="log-actions">
                            <button class="log-btn">Retry</button>
                            <button class="log-btn">Details</button>
                        </div>
                    </div>

                    <div class="log-item">
                        <div class="log-time">15:25</div>
                        <div class="log-message">Mission "Transport Package A → B" started</div>
                        <div class="log-actions">
                            <button class="log-btn">Details</button>
                        </div>
                    </div>

                    <div class="log-item success">
                        <div class="log-time">15:20</div>
                        <div class="log-message">System initialization completed - all systems operational</div>
                        <div class="log-actions">
                            <button class="log-btn">Details</button>
                        </div>
                    </div>

                    <div class="log-item">
                        <div class="log-time">15:15</div>
                        <div class="log-message">Emergency stop released - system ready for operation</div>
                        <div class="log-actions">
                            <button class="log-btn">Details</button>
                        </div>
                    </div>

                    <div class="log-item error">
                        <div class="log-time">15:10</div>
                        <div class="log-message">Emergency stop activated by operator</div>
                        <div class="log-actions">
                            <button class="log-btn">Acknowledge</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- JavaScript -->
    <script>
        // Initialize Lucide Icons
        lucide.createIcons();

        // Tab Navigation
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                const tabId = button.getAttribute('data-tab');
                
                // Update tab buttons
                document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                
                // Update tab content
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                document.getElementById(tabId).classList.add('active');
                
                // Update sidebar submenu
                document.querySelectorAll('.sidebar-submenu-item').forEach(item => item.classList.remove('active'));
                document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
            });
        });

        // Sidebar Submenu Navigation
        document.querySelectorAll('.sidebar-submenu-item').forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                const tabId = item.getAttribute('data-tab');
                
                // Update submenu items
                document.querySelectorAll('.sidebar-submenu-item').forEach(subItem => subItem.classList.remove('active'));
                item.classList.add('active');
                
                // Update tab buttons
                document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
                
                // Update tab content
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Mode Buttons
        document.querySelectorAll('.mode-btn').forEach(button => {
            button.addEventListener('click', () => {
                document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
            });
        });

        // Movement Buttons
        document.querySelectorAll('.movement-btn').forEach(button => {
            button.addEventListener('mousedown', () => {
                button.style.transform = 'scale(0.95)';
            });
            
            button.addEventListener('mouseup', () => {
                button.style.transform = 'scale(1)';
            });
            
            button.addEventListener('mouseleave', () => {
                button.style.transform = 'scale(1)';
            });
        });

        // Speed Control
        const speedSlider = document.querySelector('.speed-slider');
        const speedDisplay = document.querySelector('.speed-display');
        const speedPresets = document.querySelectorAll('.speed-preset');

        speedSlider.addEventListener('input', (e) => {
            const value = e.target.value;
            speedDisplay.textContent = `${value}%`;
            
            // Update presets
            speedPresets.forEach(preset => preset.classList.remove('active'));
        });

        speedPresets.forEach(preset => {
            preset.addEventListener('click', () => {
                const speed = preset.getAttribute('data-speed');
                speedSlider.value = speed;
                speedDisplay.textContent = `${speed}%`;
                
                speedPresets.forEach(p => p.classList.remove('active'));
                preset.classList.add('active');
            });
        });

        // Emergency Functions
        function triggerEmergencyStop() {
            const estopButton = document.querySelector('.estop-button');
            estopButton.classList.add('animate-shake');
            
            // Add emergency alert
            const alertBanner = document.querySelector('.alert-banner');
            const emergencyAlert = document.createElement('div');
            emergencyAlert.className = 'alert-item alert-critical animate-shake';
            emergencyAlert.innerHTML = '<i data-lucide="alert-triangle"></i><span>EMERGENCY STOP ACTIVATED!</span>';
            alertBanner.insertBefore(emergencyAlert, alertBanner.firstChild);
            
            // Remove animation after completion
            setTimeout(() => {
                estopButton.classList.remove('animate-shake');
            }, 400);
            
            // Reinitialize icons
            lucide.createIcons();
        }

        function triggerPause() {
            console.log('Pause triggered');
        }

        function triggerReset() {
            console.log('Reset triggered');
        }

        function triggerHome() {
            console.log('Home triggered');
        }

        // Mission Actions
        document.querySelectorAll('.mission-btn').forEach(button => {
            button.addEventListener('click', () => {
                button.classList.add('animate-bounce');
                setTimeout(() => {
                    button.classList.remove('animate-bounce');
                }, 600);
            });
        });

        // Log Actions
        document.querySelectorAll('.log-btn').forEach(button => {
            button.addEventListener('click', () => {
                button.classList.add('animate-bounce');
                setTimeout(() => {
                    button.classList.remove('animate-bounce');
                }, 600);
            });
        });

        // Statistics Animation
        function animateCountUp(element) {
            const target = parseInt(element.getAttribute('data-value'));
            const duration = 1000;
            const step = target / (duration / 16);
            let current = 0;
            
            const timer = setInterval(() => {
                current += step;
                if (current >= target) {
                    current = target;
                    clearInterval(timer);
                }
                element.textContent = Math.floor(current);
            }, 16);
        }

        // Animate statistics when tab becomes active
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                    if (mutation.target.classList.contains('active')) {
                        const statValues = mutation.target.querySelectorAll('.stat-value');
                        statValues.forEach(animateCountUp);
                    }
                }
            });
        });

        document.querySelectorAll('.tab-content').forEach(content => {
            observer.observe(content, { attributes: true });
        });

        // Update Last Update Time
        setInterval(() => {
            const lastUpdateElement = document.querySelector('.alert-item:last-child span');
            if (lastUpdateElement && lastUpdateElement.textContent.includes('Last Update:')) {
                const seconds = Math.floor(Math.random() * 5) + 1;
                lastUpdateElement.textContent = `Last Update: ${seconds}s ago`;
            }
        }, 2000);

        // Simulate real-time updates
        setInterval(() => {
            // Update battery level
            const batteryElement = document.querySelector('.alert-item:nth-child(2) span');
            if (batteryElement) {
                const currentBattery = parseInt(batteryElement.textContent.match(/\d+/)[0]);
                const newBattery = Math.max(10, currentBattery - Math.floor(Math.random() * 2));
                batteryElement.textContent = `Low Battery: ${newBattery}%`;
            }
        }, 5000);
    </script>
</body>
</html>
